---
title: "AlunosUFCG"
author: "Rodolfo Viana"
date: "13-06-2015"
output: html_document
---



```{r}
library(dplyr)

training <- read.csv("~/Projetos/DataAnalysis/Assignment5/training.csv")
training$MATRICULA <- as.factor(training$MATRICULA)
training$COD_CURSO <- as.factor(training$COD_CURSO)
training$MEDIA <- as.numeric(as.character(training$MEDIA))
training$COD_EVASAO <- as.factor(training$COD_EVASAO)
levels(training$SITUACAO)[1] = "missing"
levels(training$PERIODO_INGRESSO)[1] = "missing"
levels(training$CURSO)[1] = "missing"
levels(training$CREDITOS)[1] = "missing"
levels(training$DEPARTAMENTO)[1] = "missing"
levels(training$DISCIPLINA)[1] = "missing"


set.seed(12345) 
primeiro_periodo <- filter(training, PERIODO_RELATIVO == 1)

primeiro_training <- primeiro_periodo[order(runif(nrow(primeiro_periodo))), ]

training_train <- primeiro_training[1:round(0.9*nrow(primeiro_periodo)), ]
training_test <- primeiro_training[round(0.9*nrow(primeiro_periodo)):nrow(primeiro_periodo), ]
prop.table(table(training_train$COD_EVASAO))
prop.table(table(training_test$COD_EVASAO))

library("C50")

training_train$CURSO <- NULL
training_train$DEPARTAMENTO <- NULL
training_train$DISCIPLINA <- NULL

model <- C5.0(training_train[,-11], training_train$COD_EVASAO)
model
summary(model)
```

Testando o modelo

```{r}
training_test$CURSO <- NULL
training_test$DEPARTAMENTO <- NULL
training_test$DISCIPLINA <- NULL

pred <- predict(model, training_test)

true_eva <- training_test$COD_EVASAO == 1
table(pred, true_eva)
```


```{r}
test_first_round_kaggle <- read.csv("~/Projetos/DataAnalysis/Assignment5/test_first_round_kaggle.csv")

test_first_round_kaggle$CURSO <- NULL
test_first_round_kaggle$DEPARTAMENTO <- NULL
test_first_round_kaggle$DISCIPLINA <- NULL

test_first_round_kaggle$MATRICULA <- as.factor(test_first_round_kaggle$MATRICULA)
test_first_round_kaggle$COD_CURSO <- as.factor(test_first_round_kaggle$COD_CURSO)
test_first_round_kaggle$MEDIA <- as.numeric(as.character(test_first_round_kaggle$MEDIA))


pred <- predict(model, test_first_round_kaggle)
pred

str(test_first_round_kaggle)


```

